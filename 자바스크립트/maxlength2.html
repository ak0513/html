<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>iOS maxlength 우회</title>
  <style>
    .input-wrap {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="input-wrap">
    <label>기본 인풋: </label>
    <input type="text" class="limit-input" data-maxlength="10">
  </div>

  <div class="input-wrap">
    <label>동적 생성 인풋: </label>
    <button id="add-input">인풋 추가</button>
    <div id="dynamic-container"></div>
  </div>

  <script>
    function enforceMaxLength(input) {
      const max = parseInt(input.dataset.maxlength, 10);
      const value = input.value;
      const charArray = [...value]; // 이모지, 조합문자 등 분리 대응
      if (charArray.length > max) {
        input.value = charArray.slice(0, max).join('');
      }
    }

    function bindInputEnforce(el) {
      el.addEventListener('input', () => enforceMaxLength(el));
    }

    // 초기 static 인풋 바인딩
    document.querySelectorAll('.limit-input').forEach(bindInputEnforce);

    // 동적 생성
    document.getElementById('add-input').addEventListener('click', () => {
      const input = document.createElement('input');
      input.type = 'text';
      input.className = 'limit-input';
      input.dataset.maxlength = '10';
      input.placeholder = '동적 인풋';
      bindInputEnforce(input);
      document.getElementById('dynamic-container').appendChild(input);
    });
  </script>
</body>
</html>