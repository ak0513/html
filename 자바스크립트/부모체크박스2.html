<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>부모-자식 체크박스 (시멘틱 개선)</title>
</head>
<body>

    <!-- 기존 체크박스 그룹 -->
    <div id="checkbox-container">
        <div data-group-wrapper="group1">
            <label>
                <input type="checkbox" data-role="group-selector" data-group-id="group1"> 전체 선택 (그룹 1)
            </label>
            <br>
            <label>
                <input type="checkbox" data-role="group-item" data-group-id="group1"> 항목 1-1
            </label>
            <br>
            <label>
                <input type="checkbox" data-role="group-item" data-group-id="group1"> 항목 1-2
            </label>
        </div>
    </div>

    <button onclick="addCheckboxSet()">부모-자식 세트 추가</button>

    <script>
        document.addEventListener("change", function (event) {
            const target = event.target;

            // 부모 체크박스 동작 (그룹 전체 선택/해제)
            if (target.matches("[data-role='group-selector']")) {
                const groupId = target.dataset.groupId;
                const childCheckboxes = document.querySelectorAll(`[data-role='group-item'][data-group-id='${groupId}']`);

                childCheckboxes.forEach(child => {
                    child.checked = target.checked;
                });
            }

            // 자식 체크박스 동작 (전체 체크 시 부모 체크박스 업데이트)
            if (target.matches("[data-role='group-item']")) {
                const groupId = target.dataset.groupId;
                const parentCheckbox = document.querySelector(`[data-role='group-selector'][data-group-id='${groupId}']`);
                const childCheckboxes = document.querySelectorAll(`[data-role='group-item'][data-group-id='${groupId}']`);

                const allChecked = Array.from(childCheckboxes).every(child => child.checked);
                parentCheckbox.checked = allChecked;
            }
        });

        // 부모-자식 세트를 동적으로 추가하는 함수
        function addCheckboxSet() {
            const container = document.getElementById("checkbox-container");
            const groupId = `group${document.querySelectorAll("[data-group-wrapper]").length + 1}`;

            const newGroup = document.createElement("div");
            newGroup.setAttribute("data-group-wrapper", groupId);
            newGroup.innerHTML = `
                <label>
                    <input type="checkbox" data-role="group-selector" data-group-id="${groupId}"> 전체 선택 (${groupId})
                </label>
                <br>
                <label>
                    <input type="checkbox" data-role="group-item" data-group-id="${groupId}"> 항목 1
                </label>
                <br>
                <label>
                    <input type="checkbox" data-role="group-item" data-group-id="${groupId}"> 항목 2
                </label>
            `;
            container.appendChild(newGroup);
        }
    </script>

</body>
</html>