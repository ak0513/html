<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>운동 기록</title>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <div id="wrap">
        <div id="searchBar">
            <input type="text" id="searchInput" placeholder="검색어 입력" oninput="searchData()">
            <button type="button" id="btnDelete" onclick="deleteSearch()"><img src="./img/icon-close.svg" alt="닫기"></button>
        </div>
        <div id="btnTop">
            <div class="btnTop-inner">
                <button type="button" onclick="sortData('date')" class="btn-date">날짜</button>
                <div id="btnPart"></div>
            </div>
        </div>
        <div id="btnKindWrap">
            <div id="btnKind"></div>
        </div>
        <div id="container"></div>

        <video id="펙 덱 플라이" controls><source src="./video/pecDecFly.mp4" type="video/mp4"></video>
        <!-- https://myhappybody.net/tests/1rm -->
    </div>
    <script>
        var data = [
            // 덤벨은 개당 무게로, 원판은 양쪽 무게로, 머신 기본 무게는 제외
            {date: "2024.07.27", part: "하체", kind: "레그 컬", set: [{weight: "25", number: "20"}, {weight: "30", number: "20"}, {weight: "35", number: "20"}], desc: "다음 30kg부터 시작"},
            {date: "2024.07.27", part: "하체", kind: "레그 익스텐션", set: [{weight: "25", number: "20"}, {weight: "25", number: "20"}, {weight: "30", number: "20"}]},
            {date: "2024.07.27", part: "하체", kind: "레그 프레스", set: [{weight: "0", number: "15"}, {weight: "10", number: "20"}, {weight: "20", number: "20"}, {weight: "20", number: "20"}], desc:"20kg할만했으나 4세트부터 힘들었음"},
            {date: "2024.07.27", part: "어깨", kind: "리버스 펙 덱 플라이", set: [{weight: "20", number: "20"}, {weight: "20", number: "20"}, {weight: "20", number: "13"}, {weight: "15", number: "7"}], desc: "20kg 힘듬"}, 
            {date: "2024.07.27", part: "어깨", kind: "숄더 프레스", set: [{weight: "25", number: "20"}, {weight: "25", number: "20"}, {weight: "25", number: "10"}, {weight: "20", number: "10"}], desc: "20kg인지 25kg으로 시작한지 기억이 안남. 처음부터 힘들었음", method:"시티드"},

            {date: "2024.07.25", part: "가슴", kind: "펙 덱 플라이", set: [{weight: "25", number: "15"}, {weight: "30", number: "20"}, {weight: "30", number: "20"}]},
            {date: "2024.07.25", part: "가슴", kind: "체스트 프레스", set: [{weight: "40", number: "20"}, {weight: "40", number: "20"}, {weight: "40", number: "15"}], method: "원판 머신"},
            {date: "2024.07.25", part: "등", kind: "시티드 로우", set: [{weight: "20", number: "20"}, {weight: "25", number: "20"}, {weight: "25", number: "15"}, {weight: "25", number: "15"}]},
            {date: "2024.07.25", part: "등", kind: "랫 풀다운", set: [{weight: "25", number: "20"}, {weight: "25", number: "20"}, {weight: "25", number: "20"}]},
            {date: "2024.07.25", part: "가슴", kind: "딥스", set: [{weight: "40", number: "20"}, {weight: "50", number: "20"}, {weight: "50", number: "20"}], method: "어시스트"},
            {date: "2024.07.25", part: "가슴", kind: "벤치 프레스", set: [{weight: "20", number: "10"}, {weight: "15", number: "12"}, {weight: "15", number: "10"}], method: "인클라인 머신"},

            {date: "2024.07.22", part: "어깨", kind: "레터럴 레이즈", set: [{weight:"5", number:"20"},{weight:"5", number:"20"},{weight:"5", number:"20"},], method: "케이블"},
            {date: "2024.07.22", part: "어깨", kind: "오버헤드 프레스", set: [{weight:"0", number:"20"},{weight:"5", number:"20"}], method: "스미스머신"},
            {date: "2024.07.22", part: "하체", kind: "레그 컬", set: [{weight: "20", number: "20"}, {weight: "25", number: "20"}, {weight: "30", number: "20"}]},
            {date: "2024.07.22", part: "하체", kind: "스쿼트", set: [{weight: "0", number: "20"}, {weight: "10", number: "20"}, {weight: "15", number: "20"}], method: "스미스머신"},
            {date: "2024.07.22", part: "하체", kind: "스쿼트", set: [{weight: "", number: "20"}, {weight: "", number: "20"}, {weight: "", number: "15"}], method: "원 레그"},

            {date: "2024.07.20", part: "등", kind: "암 풀다운", set: [{weight: "15", number: "15"}, {weight: "20", number: "20"}, {weight: "20", number: "20"}, {weight: "25", number: "20"}], desc: "", method: "케이블"}, 
            {date: "2024.07.20", part: "등", kind: "랫 풀다운", set: [{weight: "25", number: "20"}, {weight: "25", number: "20"}, {weight: "30", number: "20"}], desc: ""}, 
            {date: "2024.07.20", part: "등", kind: "시티드 로우", set: [{weight: "25", number: "20"}, {weight: "30", number: "20"}, {weight: "35", number: "20"}], desc: "35kg 괜찮음"}, 
            {date: "2024.07.20", part: "등", kind: "티 바 로우", set: [{weight: "5", number: "20"}, {weight: "10", number: "20"}, {weight: "10", number: "20"}], desc: ""}, 
            {date: "2024.07.20", part: "가슴", kind: "푸쉬업", set: [{weight: "", number: "15"}, {weight: "", number: "20"}, {weight: "", number: "20"}, {weight: "", number: "20"}], desc: "4번째 칸", method: "스미스머신 인클라인"},

            {date: "2024.07.17", part: "등", kind: "암 풀다운", set: [{weight: "15", number: "20"}, {weight: "20", number: "20"}, {weight: "25", number: "20"}], method: "로프 그립 케이블"},
            {date: "2024.07.17", part: "등", kind: "풀업", set: [{weight: "", number: "15"}, {weight: "", number: "12"}, {weight: "", number: "10"}], method: "밴드"},
            {date: "2024.07.17", part: "등", kind: "벤트 오버 로우", set: [{weight: "20", number: "20"}, {weight: "15", number: "20"}, {weight: "15", number: "20"}], method: "바벨"},
            {date: "2024.07.17", part: "등", kind: "시티드 로우", set: [{weight: "20", number: "20"}, {weight: "30", number: "20"}, {weight: "30", number: "20"}]},
            {date: "2024.07.17", part: "가슴", kind: "벤치 프레스", set: [{weight:"20", number:"20"},{weight:"25", number:"20"},{weight:"30", number:"15"}]},
            {date: "2024.07.17", part: "가슴", kind: "체스트 플라이", set: [{weight:"5", number:"20"},{weight:"10", number:"20"},{weight:"10", number:"15"}], method: "케이블"},

            {date: "2024.07.13", part: "등", kind: "랫 풀다운", set: [{weight: "20", number: "20"}, {weight: "25", number: "20"}, {weight: "25", number: "20"}, {weight: "30", number: "20"}, {weight: "30", number: "20"}], desc: "다음은 25kg로 시작해서 힘이 되면 35kg"},
            {date: "2024.07.13", part: "등", kind: "암 풀다운", set: [{weight: "15", number: "20"}, {weight: "15", number: "20"}, {weight: "20", number: "20"}], desc: "다음은 15kg로 시작", method: "케이블"},
            {date: "2024.07.13", part: "등", kind: "티 바 로우", set: [{weight: "0", number: "20"}, {weight: "5", number: "20"}, {weight: "10", number: "20"}], desc: "다음은 5kg으로 시작"},
            {date: "2024.07.13", part: "등", kind: "백 익스텐션", set: [{weight: "", number: "15"}, {weight: "", number: "15"}, {weight: "", number: "15"}]},
            {date: "2024.07.13", part: "가슴", kind: "딥스", set: [{weight: "", number: "15"}, {weight: "", number: "15"}, {weight: "", number: "20"}], desc: "점프해서 버티며 내려오기"},

            {date: "2024.07.10", part: "하체", kind: "스쿼트", set: [{weight: "0", number: "20"}, {weight: "20", number: "20"}, {weight: "30", number: "20"}], method: "브이"},
            {date: "2024.07.10", part: "하체", kind: "레그 프레스", set: [{weight:"0", number:"20"},{weight:"20", number:"20"},{ weight:"30", number:"20",},]},
            {date: "2024.07.10", part: "하체", kind: "스쿼트", set: [{weight: "5", number: "20"}, {weight: "5", number: "20"}, {weight: "5", number: "15"}], method: "덤벨"},
            {date: "2024.07.10", part: "어깨", kind: "숄더 프레스", set: [{weight:"5", number:"20"},{weight:"6", number:"20"},{weight:"6", number:"15"},], method:"인클라인 덤벨"},
            {date: "2024.07.10", part: "어깨", kind: "레터럴 레이즈", set: [{weight:"3", number:"20"},{weight:"4", number:"20"},{weight:"4", number:"20"},], method: "사이드"},
            {date: "2024.07.10", part: "어깨", kind: "페이스 풀", set: [{weight:"5", number:"20"},{weight:"5", number:"20"},{weight:"5", number:"20"},], method: "케이블"},
            {date: "2024.07.10", part: "가슴", kind: "푸쉬업", set: [{weight: "", number: "20"}, {weight: "", number: "20"}, {weight: "", number: "20"}], method:"인클라인"},

            {date: "2024.07.09", part: "가슴", kind: "푸쉬업", set: [{weight: "", number: "20"}, {weight: "", number: "15"}, {weight: "", number: "10"}], method:"니"},

            {date: "2024.07.08", part: "등", kind: "데드 리프트", set: [{weight: "0", number: "20"}, {weight: "10", number: "20"}, {weight: "20", number: "20"},{weight: "30", number: "20"}], method: "스미스머신 컨벤셔널"},
            {date: "2024.07.08", part: "등", kind: "암 풀다운", set: [{weight: "5", number: "20"}, {weight: "10", number: "20"}, {weight: "10", number: "20"}], method: "케이블"},
            {date: "2024.07.08", part: "등", kind: "랫 풀다운", set: [{weight: "20", number: "20"}, {weight: "25", number: "20"}, {weight: "30", number: "20"}], desc:"언더 그립이 무게를 더 친다.", method: "스미스머신 컨벤셔널"},
            {date: "2024.07.08", part: "등", kind: "티 바 로우", set: [{weight: "0", number: "20"}, {weight: "5", number: "20"}, {weight: "5", number: "20"}], method:"바벨봉"},
            {date: "2024.07.08", part: "가슴", kind: "딥스", set: [{weight: "", number: "20"}, {weight: "", number: "20"}, {weight: "", number: "20"}], desc:"점프해서 버티고 내려오기"},

            {date: "2024.07.05", part: "하체", kind: "레그 컬", set: [{weight: "12", number: "20"}, {weight: "16", number: "20"}, {weight: "20", number: "20"},{weight: "24", number: "20"}]},
            {date: "2024.07.05", part: "하체", kind: "스쿼트", set: [{weight: "15", number: "20"}, {weight: "15", number: "20"}, {weight: "15", number: "20"}], method: "와이드"},
            {date: "2024.07.05", part: "하체", kind: "스쿼트", set: [{weight: "", number: "20"}, {weight: "", number: "15"}, {weight: "", number: "12"}], desc: "5초 버티기", method: "불가리안 스플릿"},
            {date: "2024.07.05", part: "어깨", kind: "밀리터리 프레스", set: [{weight:"9.5", number:"20"},{weight:"11.5", number:"20"},{weight:"11.5", number:"5"},], desc:'마지막 세트 도움받아 15개'},
            {date: "2024.07.05", part: "어깨", kind: "프론트 레이즈", set: [{weight:"5", number:"20"},{weight:"5", number:"20"},{weight:"5", number:"20"},], method:'원판'},
            {date: "2024.07.05", part: "등", kind: "암 풀다운", set: [{weight:"0", number:"20"},{weight:"0", number:"20"},{weight:"0", number:"20"},], method:'파란색 밴드'},

            {date: "2024.07.02", part: "등", kind: "랫 풀다운", set: [{weight: "20", number: "20"}, {weight: "25", number: "20"}, {weight: "30", number: "20"}]},
            {date: "2024.07.02", part: "등", kind: "티 바 로우", set: [{weight:"0", number:"20"},{weight:"10", number:"20"},{weight:"10", number:"20"}]},
            {date: "2024.07.02", part: "가슴", kind: "푸쉬업", set: [{weight:"", number:"20"},{weight:"", number:"20"},{weight:"", number:"20"}],method:"인클라인"},
            {date: "2024.07.02", part: "등", kind: "백 익스텐션", set: [{weight: "", number: "15"}, {weight: "", number: "15"}, {weight: "", number: "15"}]},
            {date: "2024.07.02", part: "가슴", kind: "딥스", set: [{weight: "", number: "15"}, {weight: "", number: "15"}, {weight: "", number: "20"}]},

            {date: "2024.06.27", part: "등", kind: "데드 리프트", set: [{weight: "20", number: "20"}, {weight: "25", number: "20"}, {weight: "30", number: "20"}], method: "루마니안"},
            {date: "2024.06.27", part: "가슴", kind: "체스트 프레스", set: [{weight: "5", number: "20"}, {weight: "6", number: "20"}], method: "인클라인 덤벨"},
            {date: "2024.06.27", part: "등", kind: "티 바 로우", set: [{weight: "0", number: "20"}, {weight: "5", number: "20"}, {weight: "10", number: "20"}]},
            {date: "2024.06.27", part: "하체", kind: "사이드 스텝", set: [{weight: "", number: "20"}, {weight: "", number: "20"}, {weight: "", number: "30"}, {weight: "", number: "25"}]},
            {date: "2024.06.27", part: "코어", kind: "크런치", set: [{weight: "", number: "20"}, {weight: "", number: "20"}, {weight: "", number: "20"}]},

            {date: "2024.06.24", part: "어깨", kind: "밀리터리 프레스", set: [{weight:"9.5", number:"20"},{weight:"9.5", number:"20"},{weight:"9.5", number:"20"},]},
            {date: "2024.06.24", part: "어깨", kind: "숄더 프레스", set: [{weight:"3", number:"20"},{weight:"1.5", number:"20"},{weight:"1.5", number:"20"},], method: "인클라인 덤벨"},
            {date: "2024.06.24", part: "어깨", kind: "레터럴 레이즈", set: [{weight:"3", number:"20"},{weight:"3", number:"20"},{weight:"3", number:"20"},], method: "사이드"},
            {date: "2024.06.24", part: "어깨", kind: "벤트 오버 레터럴 레이즈", set: [{weight:"3", number:"20"},{weight:"3", number:"20"},{weight:"3", number:"20"},]},
            {date: "2024.06.24", part: "하체", kind: "레그 프레스", set: [{weight:"0", number:"20"},{weight:"20", number:"20"},{weight:"20", number:"20"},{weight:"20", number:"20"},]},
            {date: "2024.06.24", part: "코어", kind: "버피", set: [{weight:"0", number:"20"},{weight:"0", number:"20"},{weight:"0", number:"20"},{weight:"0", number:"20"},]},

            {date: "2024.06.20", part: "가슴", kind: "벤치 프레스", set: [{weight:"15", number:"20"},{weight:"15", number:"20"},{weight:"20", number:"15"},{weight:"20", number:"15"},]},
            {date: "2024.06.20", part: "가슴", kind: "체스트 프레스", set: [{weight:"4", number:"20"},{weight:"5", number:"20"},{weight:"6", number:"20"},], method: "인클라인 덤벨"},
            {date: "2024.06.20", part: "가슴", kind: "딥스", set: [{weight:"", number:"20"},{weight:"", number:"20"},{weight:"", number:"20"},]},
            {date: "2024.06.20", part: "등", kind: "랫 풀다운", set: [{weight:"20", number:"20"},{weight:"25", number:"20"},{weight:"30", number:"15"},]},
            {date: "2024.06.20", part: "등", kind: "벤트 오버 로우", set: [{weight:"15", number:"20"},{weight:"15", number:"20"},{weight:"9.5", number:"20"},], method: "바벨"},
            {date: "2024.06.20", part: "코어", kind: "마운틴 클라이머", set: [{weight:"", number:"20"},{weight:"", number:"30초"},{weight:"", number:"30초"},{weight:"", number:"30초"}]},

            {date: "2024.06.17", part: "하체", kind: "스쿼트", set: [{weight:"20", number:"20"},{weight:"25", number:"15"},{weight:"30", number:"12"},{weight:"35", number:"10"},]},
            {date: "2024.06.17", part: "하체", kind: "런지", set: [{weight:"0", number:"20"},{weight:"0", number:"20"},{weight:"0", number:"20"}],desc: "5초 버티기"},
            {date: "2024.06.17", part: "하체", kind: "힙 스터스트", set: [{weight:"0", number:"20"},{weight:"0", number:"20"},{weight:"0", number:"20"},],desc: "밴드 끼고"},
            {date: "2024.06.17", part: "어깨", kind: "레터럴 레이즈", set: [{weight:"1.5", number:"20"},{weight:"3", number:"20"}], method: "사이드"},
            {date: "2024.06.17", part: "어깨", kind: "써클 레이즈", set: [{weight:"1", number:"20"},{weight:"1", number:"20"}]},

            {date: "2024.06.13", part: "등", kind: "데드 리프트", set: [{weight:"20", number:"20"},{weight:"20", number:"20"},{weight:"20", number:"20"},], method: "루마니안"},
            {date: "2024.06.13", part: "등", kind: "랫 풀다운", set: [{weight:"20", number:"20"},{weight:"30", number:"20"},{weight:"35", number:"15"},]},
            {date: "2024.06.13", part: "등", kind: "시티드 로우", set: [{weight:"20", number:"20"},{weight:"25", number:"20"},{weight:"30", number:"20"},], method: "케이블"},
            {date: "2024.06.13", part: "가슴", kind: "벤치 프레스", set: [{weight:"20", number:"20"},{weight:"20", number:"20"},{weight:"20", number:"20"},]},
            {date: "2024.06.13", part: "가슴", kind: "딥스", set: [{weight:"", number:"20"},{weight:"", number:"15"}]},

            {date: "2024.06.10", part: "코어", kind: "힙 브릿지", set: [{weight:"", number:"20"},{weight:"", number:"20"},{weight:"", number:"20"},], desc: "10초 버티기"},
            {date: "2024.06.10", part: "하체", kind: "스쿼트", set: [{weight:"20", number:"20"},{weight:"25", number:"20"},{weight:"30", number:"20"},{weight:"0", number:"20"},]},
            {date: "2024.06.10", part: "하체", kind: "레그 컬", set: [{weight:"8", number:"20"},{weight:"12", number:"20"},{weight:"16", number:"20"},]},
            {date: "2024.06.10", part: "어깨", kind: "밀리터리 프레스", set: [{weight:"9.5", number:"20"},{weight:"9.5", number:"20"},{weight:"9.5", number:"20"},]},
            {date: "2024.06.10", part: "어깨", kind: "숄더 프레스", set: [{weight:"3", number:"12"},{weight:"3", number:"12"}], method: "인클라인 덤벨"},
            {date: "2024.06.10", part: "어깨", kind: "레터럴 레이즈", set: [{weight:"1.5", number:"20"},{weight:"1.5", number:"20"},{weight:"1.5", number:"20"},], method: "사이드"},

            {date: "2024.06.07", part: "등", kind: "랫 풀다운", set: [{ weight:"20", number:"20"},{weight:"25", number:"20"},{weight:"30", number:"20"},]},
            {date: "2024.06.07", part: "가슴", kind: "벤치 프레스", set: [{weight:"15", number:"20"},{weight:"20", number:"20"},{weight:"20", number:"20"},]},
            {date: "2024.06.07", part: "등", kind: "티 바 로우", set: [{weight:"0", number:"20"},{weight:"5", number:"20"},{weight:"5", number:"20"},{weight:"5", number:"20"},]},
            {date: "2024.06.07", part: "가슴", kind: "체스트 프레스", set: [{weight:"5", number:"20"},{ weight:"5", number:"20",},{ weight:"5", number:"20",},], method: "인클라인 덤벨"},
            {date: "2024.06.07", part: "등", kind: "백 익스텐션", set: [{weight:"", number:"15"},{weight:"", number:"15"},{weight:"", number:"15"},],desc: "5초 버티기"},
            
            {date: "2024.06.04", part: "하체", kind: "스쿼트", set: [{number:"20", weight:"15"},{number:"20", weight:"20"},]},
            {date: "2024.06.04", part: "하체", kind: "레그 프레스", set: [{weight:"0", number:"20"},{weight:"0", number:"20"},{ weight:"0", number:"20",},],desc: "5초 버티기"},
            {date: "2024.06.04", part: "어깨", kind: "밀리터리 프레스", set: [{weight:"9", number:"20"},{weight:"9", number:"20"},{weight:"9", number:"20"},]},
            {date: "2024.06.04", part: "어깨", kind: "레터럴 레이즈", set: [{weight:"1", number:"20"},{weight:"1.5", number:"20"},], method: "사이드"},
        ]

        var buttonPartContainer = document.getElementById('btnPart');
        var buttonKindContainer = document.getElementById('btnKind');
        var wrap = document.getElementById('wrap');
        var container = document.getElementById('container');

        // 데이터를 정렬하고 DOM에 추가하는 함수
        function sortData(criterion) {
            var groupedData = groupDataByCriterion(criterion);

            container.innerHTML = '';

            var sortedKeys = Object.keys(groupedData).sort((a, b) => {
                return criterion === 'date' ? new Date(b) - new Date(a) : a.localeCompare(b);
            });

            sortedKeys.forEach(key => {
                setTitle(key);
                groupedData[key].forEach(item => {
                    setKind(item, criterion);
                });
            });

            setPartButtons();
        }

        // 데이터를 기준에 따라 그룹화하는 함수
        function groupDataByCriterion(criterion) {
            return data.reduce((acc, item) => {
                var key = item[criterion];
                if (!acc[key]) {
                    acc[key] = [];
                }
                acc[key].push(item);
                return acc;
            }, {});
        }

        // part 버튼 설정
        function setPartButtons() {
            var partCounts = data.reduce((acc, item) => {
                acc[item.part] = (acc[item.part] || 0) + 1;
                return acc;
            }, {});

            var parts = Object.keys(partCounts).sort((a, b) => partCounts[b] - partCounts[a]);

            buttonPartContainer.innerHTML = '';
            parts.forEach(part => {
                var button = document.createElement('button');
                button.setAttribute('type', 'button');
                button.textContent = `${part}(${partCounts[part]})`;
                button.onclick = function() { 
                    showPart(part);
                    manageActiveButton(buttonPartContainer, button);
                };
                buttonPartContainer.appendChild(button);
            });
        }

        // 특정 part의 데이터를 표시하고 kind 버튼을 모두 노출하는 함수
        function showPart(part) {
            var partData = data.filter(item => item.part === part);
            var kindCounts = partData.reduce((acc, item) => {
                acc[item.kind] = (acc[item.kind] || 0) + 1;
                return acc;
            }, {});

            wrap.classList.add('showdepth2')

            var kinds = Object.keys(kindCounts).sort((a, b) => kindCounts[b] - kindCounts[a]);

            buttonKindContainer.innerHTML = '';
            kinds.forEach(kind => {
                var button = document.createElement('button');
                button.setAttribute('type', 'button');
                button.textContent = `${kind}(${kindCounts[kind]})`;
                button.onclick = function() { 
                    showKind(kind);
                    manageActiveButton(buttonKindContainer, button);
                };
                buttonKindContainer.appendChild(button);
            });

            displayPartData(partData, part);
        }

        // part 데이터를 표시하는 함수
        function displayPartData(partData, part) {
            container.innerHTML = '';
            setTitle(part, part);
            partData.forEach(item => {
                setKind(item, 'kind');
            });
        }

        // 특정 kind의 데이터를 표시하는 함수
        function showKind(kind) {
            var kindData = data.filter(item => item.kind === kind);
            container.innerHTML = '';
            setTitle(kind, kindData[0].part);
            kindData.forEach((item, index) => {
                var dateInterval = kindData.length > index + 1 ? getDate(kindData[index+1].date, kindData[index].date) : undefined;
                // var dateInterval2 = kindData.length > index + 1 ? getDate(kindData[index+1].date, new Date()) : undefined;
                setKind(item, 'kindDate', dateInterval);
            });
        }

        // 검색 기능 추가
        function searchData() {
            var searchInput = document.getElementById('searchInput').value.trim();
            if (searchInput === '') {
                resetSearchResults();
                return;
            }
            wrap.classList.add('showdepth2')

            var searchResults = data.filter(item => item.kind.includes(searchInput));
            displaySearchResults(searchResults);
        }

        
        function deleteSearch() {
            var deleteBtn = document.getElementById('btnDelete');
            console.log(deleteBtn)
            deleteBtn.previousElementSibling.value = '';
            deleteBtn.previousElementSibling.focus();
        }

        function resetSearchResults() {
            buttonKindContainer.innerHTML = '';
            container.innerHTML = '';
            setTitle('검색 결과 없음');
        }

        function displaySearchResults(searchResults) {
            buttonKindContainer.innerHTML = '';
            container.innerHTML = '';

            if (searchResults.length === 0) {
                setTitle('검색 결과 없음');
                return;
            }

            var kindCounts = searchResults.reduce((acc, item) => {
                acc[item.kind] = (acc[item.kind] || 0) + 1;
                return acc;
            }, {});

            var kinds = Object.keys(kindCounts).sort((a, b) => kindCounts[b] - kindCounts[a]);

            kinds.forEach(kind => {
                var button = document.createElement('button');
                button.setAttribute('type', 'button');
                button.textContent = `${kind}(${kindCounts[kind]})`;
                button.onclick = function() { 
                    showKind(kind);
                    manageActiveButton(buttonKindContainer, button);
                };
                buttonKindContainer.appendChild(button);
            });

            setTitle('검색 결과');
            searchResults.forEach(item => {
                setKind(item, 'kind');
            });
        }

        // 타이틀 세팅
        function setTitle(text, part) {
            var title = document.createElement('h2');
            title.classList.add(`${part}`);
            title.innerHTML = `<button type="button" onclick="playVideo('${text}')">${text}</button>${part && part !== text ? `<span>[${part}]</span>` : ``}`;
            container.appendChild(title);
        }

        // 종류별 세팅
        function setKind(item, criterion, dateInterval) {
            var itemDiv = document.createElement('div');
            itemDiv.classList.add('item');
            itemDiv.classList.add(item.part);
            // itemDiv.innerHTML = `${criterion === 'kindDate' ? `<h3>${item.date} ${item.method !== undefined ? '[' + item.method + ']' : ''} ${dateInterval !== undefined ? '<span class="dateInterval">' + dateInterval + '일전</span>' : ''} ${dateInterval2 !== undefined ? '<span class="dateInterval">' + dateInterval2 + '일전</span>' : ''}</h3>` : `<h3>${item.method !== undefined ? item.method : ''} ${item.kind}<span>[${item.part}]</span></h3>`}`;
            itemDiv.innerHTML = `${criterion === 'kindDate' ? `<h3>${item.date} ${item.method !== undefined ? '[' + item.method + ']' : ''} ${dateInterval !== undefined ? '<span class="dateInterval">' + dateInterval + '일전</span>' : ''}</h3>` : `<h3>${item.method !== undefined ? item.method : ''} ${item.kind}<span>[${item.part}]</span></h3>`}`;

            if (item.desc) {
                var desc = document.createElement('p');
                desc.classList.add('desc')
                desc.textContent = item.desc;
                itemDiv.appendChild(desc);
            }

            var setList = document.createElement('ul');
            setList.classList.add('set');

            var weights = item.set.map(setItem => parseFloat(setItem.weight));
            var maxWeight = Math.max(...weights);
            // 모두 동일한 무게인지 체크
            var isSameWeight = weights.every(weight => weight === weights[0]);

            var numbers = item.set.map(setItem => parseFloat(setItem.number));
            var maxNumber = Math.max(...numbers);
            // 모두 동일한 회수인지 체크
            var isSameNumber = numbers.every(number => number === numbers[0]);

            
            item.set.forEach(function(setItem, index) {
                var listItem = document.createElement('li');
                listItem.innerHTML = `
                <ul class="set-item">
                    <li>${index + 1}세트</li>
                    ${setItem.weight.length > 0 ? `<li class="weight">${setItem.weight}<small>kg</small></li>` : ''}<li>
                    ${setItem.number.indexOf('초') > -1 ? `<li>${setItem.number.substring(0, setItem.number.length - 1)}<small class="sec">초</small></li>` : `<li class="number">${setItem.number}<small>회</small></li>`}
                </ul>`;

                // 최대 무게 또는 회수에 클래스 추가
                if (!isSameWeight && parseFloat(setItem.weight) === maxWeight) {
                    listItem.classList.add('maxWeight');
                }
                if(!isSameNumber && parseFloat(setItem.weight.length) === 0 && parseFloat(setItem.number) === maxNumber) {
                    listItem.classList.add('maxNumber');
                }
                
                setList.appendChild(listItem);
            });
            
            itemDiv.appendChild(setList);
            container.appendChild(itemDiv);

            addClickEventToTitle(itemDiv, item);
        }
        
        // h3 태그에 클릭 이벤트 추가
        function addClickEventToTitle(itemDiv, item) {
            var h3Tag = itemDiv.querySelector('h3');
            h3Tag.addEventListener('click', function() {
                document.getElementById('searchInput').value = item.kind
                searchData();
                document.querySelector('#btnKind button').click();
            });
            
        }

        // active 클래스 관리
        function manageActiveButton(container, button) {
            var activeButton = container.querySelector('button.active');
            if (activeButton) {
                activeButton.classList.remove('active');
            }
            button.classList.add('active');
        }

        function getDate(date1, date2) {
            // 날짜 형식을 "YYYY-MM-DD"로 변환
            function convertDateFormat(dateStr) {
                var parts = dateStr.split('.');
                return parts[0] + '-' + parts[1].padStart(2, '0') + '-' + parts[2].padStart(2, '0') + 'T00:00:00';
            }
            var date1Formatted = convertDateFormat(date1);
            var date2Formatted = convertDateFormat(date2);

            var date1Obj = new Date(date1Formatted);
            var date2Obj = new Date(date2Formatted);

            return (date2Obj - date1Obj) / (1000 * 60 * 60 * 24);
        }

        function playVideo(videoEle) {
            var video = document.getElementById(videoEle);
            video.play();
        }

        // 페이지 로드 시 날짜 정렬 디폴트
        sortData('date');
    </script>
</body>
</html>
